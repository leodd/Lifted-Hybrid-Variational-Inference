grad check, T = 10
var vals
{'tau': array([0., 0., 0.]), 'Rho': array([[[ 0.50991681, -1.85678713],
        [ 0.24056996,  0.77087912],
        [ 0.53149235, -1.75466768]],

       [[-0.06536094,  0.78343238],
        [ 0.68932712,  0.65804023],
        [-0.19283901,  0.25065429]],

       [[-1.00966286, -1.63474027],
        [ 0.15892977,  1.23545078],
        [ 0.18128854,  1.4088979 ]],

       [[ 2.51623309,  0.22148364],
        [-0.96064447,  0.94839951],
        [-1.3189925 ,  1.61483975]],

       [[-1.13566564, -0.90304345],
        [-0.10693735,  0.52460358],
        [ 2.08363379,  1.02322492]],

       [[ 0.34155129,  0.37835034],
        [ 2.01884086,  0.08045707],
        [ 0.22889318, -0.82215996]]]), 'Mu': array([[5.48813504, 7.15189366, 6.02763376],
       [5.44883183, 4.23654799, 6.45894113],
       [4.37587211, 8.91773001, 9.63662761]]), 'lVar': array([[-2.38381578,  0.71950742, -1.27823867],
       [-0.98066606,  1.7370524 , -4.75837922],
       [-4.63605606, -5.1446393 ,  1.03034487]])}
['gtau', 'gRho', 'gMu', 'glVar']
numerical grads
[array([-5.63540521,  4.5763474 ,  1.05905781]), array([[[ 0.01365326, -0.01365326],
        [-1.36663802,  1.36663802],
        [ 0.0220796 , -0.0220796 ]],

       [[-0.22301026,  0.22301026],
        [-0.52162788,  0.52162788],
        [-1.38348264,  1.38348264]],

       [[-0.1446697 ,  0.1446697 ],
        [-1.87563631,  1.87563631],
        [-0.88376848,  0.88376848]],

       [[ 0.16037615, -0.16037615],
        [ 0.20319132, -0.20319132],
        [ 0.08229501, -0.08229501]],

       [[ 0.43152076, -0.43152076],
        [ 0.28215211, -0.28215211],
        [ 0.46707868, -0.46707868]],

       [[ 0.36147566, -0.36147566],
        [ 0.3851959 , -0.3851959 ],
        [ 0.70036974, -0.70036974]]]), array([[ 0.61694194,  0.60679374, -1.1873492 ],
       [ 0.33861436, -3.44477426, -1.29908882],
       [-0.60439408,  2.81550346,  3.73309412]]), array([[-0.22686007,  0.68402183, -0.11083601],
       [-0.13973935,  2.41458253, -0.15230729],
       [-0.16309041, -0.16110214,  0.98538408]])]
quad symbolic grads
[array([-5.60030731,  5.11329527,  0.48701204]), array([[[ 0.0162025 , -0.0162025 ],
        [-1.3783809 ,  1.3783809 ],
        [ 0.00951015, -0.00951015]],

       [[-0.22253313,  0.22253313],
        [-0.68426949,  0.68426949],
        [-1.22995011,  1.22995011]],

       [[-0.14464777,  0.14464777],
        [-1.93069026,  1.93069026],
        [-0.83030747,  0.83030747]],

       [[ 0.16374017, -0.16374017],
        [ 0.20549038, -0.20549038],
        [ 0.08438625, -0.08438625]],

       [[ 0.42655304, -0.42655304],
        [ 0.28094848, -0.28094848],
        [ 0.46912711, -0.46912711]],

       [[ 0.36123037, -0.36123037],
        [ 0.50358621, -0.50358621],
        [ 0.54035388, -0.54035388]]]), array([[ 0.24884923,  0.71990735, -0.77913606],
       [ 0.41697581, -3.43993348, -0.8424904 ],
       [-0.60201734, -9.96032641,  3.54892822]]), array([[-0.32460784,  0.62814393, -0.19244303],
       [-0.24179846,  2.49488015, -0.19578953],
       [-0.16315022, -0.13826068,  1.37267315]])]
relative errs
[array([0.00622811, 0.1173311 , 0.54014594]), array([[[1.86712771e-01, 1.86712771e-01],
        [8.59253326e-03, 8.59253326e-03],
        [5.69279053e-01, 5.69279053e-01]],

       [[2.13949769e-03, 2.13949769e-03],
        [3.11796242e-01, 3.11796242e-01],
        [1.10975389e-01, 1.10975389e-01]],

       [[1.51588838e-04, 1.51588838e-04],
        [2.93521474e-02, 2.93521474e-02],
        [6.04921013e-02, 6.04921013e-02]],

       [[2.09758064e-02, 2.09758064e-02],
        [1.13147465e-02, 1.13147465e-02],
        [2.54114889e-02, 2.54114889e-02]],

       [[1.15121024e-02, 1.15121024e-02],
        [4.26590279e-03, 4.26590279e-03],
        [4.38562001e-03, 4.38562001e-03]],

       [[6.78580479e-04, 6.78580479e-04],
        [3.07350913e-01, 3.07350913e-01],
        [2.28473402e-01, 2.28473402e-01]]]), array([[5.96640764e-01, 1.86411967e-01, 3.43802092e-01],
       [2.31417981e-01, 1.40525409e-03, 3.51475909e-01],
       [3.93243121e-03, 4.53767152e+00, 4.93333127e-02]]), array([[4.30872529e-01, 8.16902320e-02, 7.36286121e-01],
       [7.30353444e-01, 3.32552808e-02, 2.85490225e-01],
       [3.66763409e-04, 1.41782469e-01, 3.93033620e-01]])]
avg grads absolute err: 0.23836222509302216
bfe: 18.3597, gMu: 2.28428, gRho: 0.526773, glVar: 0.639083, gtau: 3.73354, t: 0, [0.35219378 0.31641211 0.33139411]


grad check, T = 20
var vals
{'tau': array([0., 0., 0.]), 'Rho': array([[[ 0.50991681, -1.85678713],
        [ 0.24056996,  0.77087912],
        [ 0.53149235, -1.75466768]],

       [[-0.06536094,  0.78343238],
        [ 0.68932712,  0.65804023],
        [-0.19283901,  0.25065429]],

       [[-1.00966286, -1.63474027],
        [ 0.15892977,  1.23545078],
        [ 0.18128854,  1.4088979 ]],

       [[ 2.51623309,  0.22148364],
        [-0.96064447,  0.94839951],
        [-1.3189925 ,  1.61483975]],

       [[-1.13566564, -0.90304345],
        [-0.10693735,  0.52460358],
        [ 2.08363379,  1.02322492]],

       [[ 0.34155129,  0.37835034],
        [ 2.01884086,  0.08045707],
        [ 0.22889318, -0.82215996]]]), 'Mu': array([[5.48813504, 7.15189366, 6.02763376],
       [5.44883183, 4.23654799, 6.45894113],
       [4.37587211, 8.91773001, 9.63662761]]), 'lVar': array([[-2.38381578,  0.71950742, -1.27823867],
       [-0.98066606,  1.7370524 , -4.75837922],
       [-4.63605606, -5.1446393 ,  1.03034487]])}
['gtau', 'gRho', 'gMu', 'glVar']
numerical grads
[array([-5.63932188,  4.55144873,  1.08787315]), array([[[ 0.01227128, -0.01227128],
        [-1.36050136,  1.36050136],
        [ 0.02013669, -0.02013669]],

       [[-0.22296056,  0.22296056],
        [-0.51695778,  0.51695778],
        [-1.3880577 ,  1.3880577 ]],

       [[-0.14493008,  0.14493008],
        [-1.8753356 ,  1.8753356 ],
        [-0.88385861,  0.88385861]],

       [[ 0.16058817, -0.16058817],
        [ 0.20763846, -0.20763846],
        [ 0.08083019, -0.08083019]],

       [[ 0.42638322, -0.42638322],
        [ 0.28514914, -0.28514914],
        [ 0.4690844 , -0.4690844 ]],

       [[ 0.36162837, -0.36162837],
        [ 0.39064336, -0.39064336],
        [ 0.6933263 , -0.6933263 ]]]), array([[ 0.37334605,  0.81929262, -1.15625218],
       [ 0.42085692, -3.23036217, -1.5957435 ],
       [-0.60869425,  3.13245718,  3.42044057]]), array([[-0.23878887,  0.56323938, -0.16328659],
       [-0.14459253,  2.73562615, -0.18870683],
       [-0.16317622, -0.16826596,  1.09525145]])]
quad symbolic grads
[array([-5.62751302,  4.89825228,  0.72926073]), array([[[ 0.01571317, -0.01571317],
        [-1.35779626,  1.35779626],
        [ 0.01622131, -0.01622131]],

       [[-0.22322098,  0.22322098],
        [-0.60696554,  0.60696554],
        [-1.30069633,  1.30069633]],

       [[-0.14520784,  0.14520784],
        [-1.89653796,  1.89653796],
        [-0.86342835,  0.86342835]],

       [[ 0.15873234, -0.15873234],
        [ 0.20827491, -0.20827491],
        [ 0.08074227, -0.08074227]],

       [[ 0.43836549, -0.43836549],
        [ 0.28083133, -0.28083133],
        [ 0.46361967, -0.46361967]],

       [[ 0.36194587, -0.36194587],
        [ 0.45844185, -0.45844185],
        [ 0.60551693, -0.60551693]]]), array([[ 0.38952917,  0.73370562, -1.09299005],
       [ 0.47366646, -3.46722223, -0.03868814],
       [-0.60654761, 16.83188937,  3.42921601]]), array([[-0.20232641,  0.61307725, -0.13519405],
       [-0.18749965,  2.46888971, -0.05260225],
       [-0.16363048,  0.34745321,  1.32579927]])]
relative errs
[array([0.00209402, 0.0761963 , 0.32964544]), array([[[0.28048297, 0.28048297],
        [0.00198831, 0.00198831],
        [0.1944398 , 0.1944398 ]],

       [[0.00116803, 0.00116803],
        [0.17411046, 0.17411046],
        [0.06293785, 0.06293785]],

       [[0.00191646, 0.00191646],
        [0.0113059 , 0.0113059 ],
        [0.02311485, 0.02311485]],

       [[0.01155644, 0.01155644],
        [0.0030652 , 0.0030652 ],
        [0.00108773, 0.00108773]],

       [[0.02810211, 0.02810211],
        [0.0151423 , 0.0151423 ],
        [0.01164978, 0.01164978]],

       [[0.00087798, 0.00087798],
        [0.17355598, 0.17355598],
        [0.12664941, 0.12664941]]]), array([[4.33461765e-02, 1.04464509e-01, 5.47130945e-02],
       [1.25480980e-01, 7.33230677e-02, 9.75755411e-01],
       [3.52663011e-03, 4.37338210e+00, 2.56558989e-03]]), array([[1.52697459e-01, 8.84843546e-02, 1.72044363e-01],
       [2.96745037e-01, 9.75047100e-02, 7.21248850e-01],
       [2.78388043e-03, 3.06490489e+00, 2.10497619e-01]])]
avg grads absolute err: 0.23188960709023862
bfe: 18.4164, gMu: 3.00705, gRho: 0.526792, glVar: 0.610719, gtau: 3.75168, t: 0, [0.35229836 0.31710114 0.3306005 ]


grad check, T = 50
var vals
{'tau': array([0., 0., 0.]), 'Rho': array([[[ 0.50991681, -1.85678713],
        [ 0.24056996,  0.77087912],
        [ 0.53149235, -1.75466768]],

       [[-0.06536094,  0.78343238],
        [ 0.68932712,  0.65804023],
        [-0.19283901,  0.25065429]],

       [[-1.00966286, -1.63474027],
        [ 0.15892977,  1.23545078],
        [ 0.18128854,  1.4088979 ]],

       [[ 2.51623309,  0.22148364],
        [-0.96064447,  0.94839951],
        [-1.3189925 ,  1.61483975]],

       [[-1.13566564, -0.90304345],
        [-0.10693735,  0.52460358],
        [ 2.08363379,  1.02322492]],

       [[ 0.34155129,  0.37835034],
        [ 2.01884086,  0.08045707],
        [ 0.22889318, -0.82215996]]]), 'Mu': array([[5.48813504, 7.15189366, 6.02763376],
       [5.44883183, 4.23654799, 6.45894113],
       [4.37587211, 8.91773001, 9.63662761]]), 'lVar': array([[-2.38381578,  0.71950742, -1.27823867],
       [-0.98066606,  1.7370524 , -4.75837922],
       [-4.63605606, -5.1446393 ,  1.03034487]])}
['gtau', 'gRho', 'gMu', 'glVar']
numerical grads
[array([-5.65483975,  4.5458488 ,  1.10899094]), array([[[ 0.01277327, -0.01277327],
        [-1.36371419,  1.36371419],
        [ 0.02193922, -0.02193922]],

       [[-0.22299768,  0.22299768],
        [-0.51270106,  0.51270106],
        [-1.39218387,  1.39218387]],

       [[-0.14468473,  0.14468473],
        [-1.87520299,  1.87520299],
        [-0.88417072,  0.88417072]],

       [[ 0.16058645, -0.16058645],
        [ 0.20716236, -0.20716236],
        [ 0.08033506, -0.08033506]],

       [[ 0.42820358, -0.42820358],
        [ 0.2809592 , -0.2809592 ],
        [ 0.47114248, -0.47114248]],

       [[ 0.36152725, -0.36152725],
        [ 0.3973541 , -0.3973541 ],
        [ 0.684571  , -0.684571  ]]]), array([[ 0.45666186,  0.77762317, -1.19789854],
       [ 0.41483684, -3.45595184, -1.36413372],
       [-0.60516384,  3.19673106,  3.35263628]]), array([[-0.23539804,  0.62146321, -0.1790032 ],
       [-0.15351449,  2.47404734, -0.17192093],
       [-0.16318127, -0.16692058,  1.1263005 ]])]
quad symbolic grads
[array([-5.61962161,  4.31623004,  1.30339157]), array([[[ 0.01450562, -0.01450562],
        [-1.3633543 ,  1.3633543 ],
        [ 0.00890404, -0.00890404]],

       [[-0.22281097,  0.22281097],
        [-0.45991259,  0.45991259],
        [-1.44254249,  1.44254249]],

       [[-0.14466387,  0.14466387],
        [-1.87520012,  1.87520012],
        [-0.88428434,  0.88428434]],

       [[ 0.1607522 , -0.1607522 ],
        [ 0.2068304 , -0.2068304 ],
        [ 0.08050708, -0.08050708]],

       [[ 0.44126662, -0.44126662],
        [ 0.29305517, -0.29305517],
        [ 0.44445931, -0.44445931]],

       [[ 0.36131081, -0.36131081],
        [ 0.35943362, -0.35943362],
        [ 0.73606626, -0.73606626]]]), array([[ 0.35905902,  0.82321553, -1.21257626],
       [ 0.49762457, -3.47197832, -1.17096442],
       [-0.61475134,  2.9380554 ,  3.30175636]]), array([[-0.25310163,  0.60833391, -0.15357662],
       [-0.1468199 ,  2.47341583, -0.19480762],
       [-0.16203507, -0.32714236,  1.04389377]])]
relative errs
[array([0.00622796, 0.05051175, 0.17529505]), array([[[1.35623152e-01, 1.35623152e-01],
        [2.63906679e-04, 2.63906679e-04],
        [5.94149842e-01, 5.94149842e-01]],

       [[8.37293062e-04, 8.37293062e-04],
        [1.02961515e-01, 1.02961515e-01],
        [3.61723936e-02, 3.61723936e-02]],

       [[1.44144212e-04, 1.44144212e-04],
        [1.52941937e-06, 1.52941937e-06],
        [1.28505165e-04, 1.28505165e-04]],

       [[1.03215982e-03, 1.03215982e-03],
        [1.60243364e-03, 1.60243364e-03],
        [2.14118556e-03, 2.14118556e-03]],

       [[3.05066071e-02, 3.05066071e-02],
        [4.30524030e-02, 4.30524030e-02],
        [5.66350239e-02, 5.66350239e-02]],

       [[5.98696062e-04, 5.98696062e-04],
        [9.54324562e-02, 9.54324562e-02],
        [7.52226706e-02, 7.52226706e-02]]]), array([[0.21373109, 0.05863041, 0.01225289],
       [0.19956695, 0.00463736, 0.14160584],
       [0.01584281, 0.08091881, 0.01517609]]), array([[7.52070239e-02, 2.11264268e-02, 1.42045409e-01],
       [4.36088558e-02, 2.55252937e-04, 1.33123297e-01],
       [7.02410027e-03, 9.59868337e-01, 7.31658432e-02]])]
avg grads absolute err: 0.08390935771651088
bfe: 18.4635, gMu: 1.59889, gRho: 0.52777, glVar: 0.595903, gtau: 3.74641, t: 0, [0.35229503 0.31897428 0.32873069]


grad check, T = 100
var vals
{'tau': array([0., 0., 0.]), 'Rho': array([[[ 0.50991681, -1.85678713],
        [ 0.24056996,  0.77087912],
        [ 0.53149235, -1.75466768]],

       [[-0.06536094,  0.78343238],
        [ 0.68932712,  0.65804023],
        [-0.19283901,  0.25065429]],

       [[-1.00966286, -1.63474027],
        [ 0.15892977,  1.23545078],
        [ 0.18128854,  1.4088979 ]],

       [[ 2.51623309,  0.22148364],
        [-0.96064447,  0.94839951],
        [-1.3189925 ,  1.61483975]],

       [[-1.13566564, -0.90304345],
        [-0.10693735,  0.52460358],
        [ 2.08363379,  1.02322492]],

       [[ 0.34155129,  0.37835034],
        [ 2.01884086,  0.08045707],
        [ 0.22889318, -0.82215996]]]), 'Mu': array([[5.48813504, 7.15189366, 6.02763376],
       [5.44883183, 4.23654799, 6.45894113],
       [4.37587211, 8.91773001, 9.63662761]]), 'lVar': array([[-2.38381578,  0.71950742, -1.27823867],
       [-0.98066606,  1.7370524 , -4.75837922],
       [-4.63605606, -5.1446393 ,  1.03034487]])}
['gtau', 'gRho', 'gMu', 'glVar']
numerical grads
[array([-5.65198973,  4.56209772,  1.089892  ]), array([[[ 0.01253352, -0.01253352],
        [-1.36339352,  1.36339352],
        [ 0.0219408 , -0.0219408 ]],

       [[-0.22296909,  0.22296909],
        [-0.51593124,  0.51593124],
        [-1.38907517,  1.38907517]],

       [[-0.14481763,  0.14481763],
        [-1.87539905,  1.87539905],
        [-0.88387014,  0.88387014]],

       [[ 0.1605962 , -0.1605962 ],
        [ 0.20731688, -0.20731688],
        [ 0.08045677, -0.08045677]],

       [[ 0.42838846, -0.42838846],
        [ 0.28089704, -0.28089704],
        [ 0.47109862, -0.47109862]],

       [[ 0.36163586, -0.36163586],
        [ 0.39315158, -0.39315158],
        [ 0.6899078 , -0.6899078 ]]]), array([[ 0.43496654,  0.78028365, -1.17886371],
       [ 0.37667709, -3.4466214 , -1.33530441],
       [-0.60233075,  3.06385914,  3.48267511]]), array([[-0.23894206,  0.60618027, -0.16752408],
       [-0.17458924,  2.47870906, -0.16441273],
       [-0.16228087, -0.16799416,  1.08616514]])]
quad symbolic grads
[array([-5.61721342,  4.59815972,  1.0190537 ]), array([[[ 0.01557071, -0.01557071],
        [-1.36511712,  1.36511712],
        [ 0.00896726, -0.00896726]],

       [[-0.22315254,  0.22315254],
        [-0.53843103,  0.53843103],
        [-1.36913303,  1.36913303]],

       [[-0.14457393,  0.14457393],
        [-1.89719787,  1.89719787],
        [-0.86241604,  0.86241604]],

       [[ 0.16059789, -0.16059789],
        [ 0.20728249, -0.20728249],
        [ 0.08043218, -0.08043218]],

       [[ 0.43961724, -0.43961724],
        [ 0.29283709, -0.29283709],
        [ 0.44714205, -0.44714205]],

       [[ 0.36152544, -0.36152544],
        [ 0.40662171, -0.40662171],
        [ 0.67004656, -0.67004656]]]), array([[ 0.41330506,  0.76765525, -1.10861072],
       [ 0.46520582, -3.45782287, -1.17977531],
       [-0.61209144, -0.36188003,  3.38235288]]), array([[-0.24296883,  0.61419067, -0.13770106],
       [-0.14815017,  2.47359831, -0.19433009],
       [-0.16469931, -0.35863944,  1.1605022 ]])]
relative errs
[array([0.00615293, 0.0079047 , 0.06499571]), array([[[2.42325550e-01, 2.42325550e-01],
        [1.26419792e-03, 1.26419792e-03],
        [5.91297620e-01, 5.91297620e-01]],

       [[8.22751517e-04, 8.22751517e-04],
        [4.36100478e-02, 4.36100478e-02],
        [1.43564161e-02, 1.43564161e-02]],

       [[1.68282547e-03, 1.68282547e-03],
        [1.16235614e-02, 1.16235614e-02],
        [2.42729152e-02, 2.42729152e-02]],

       [[1.05254258e-05, 1.05254258e-05],
        [1.65906598e-04, 1.65906598e-04],
        [3.05551246e-04, 3.05551246e-04]],

       [[2.62116811e-02, 2.62116811e-02],
        [4.25068601e-02, 4.25068601e-02],
        [5.08525712e-02, 5.08525712e-02]],

       [[3.05341420e-04, 3.05341420e-04],
        [3.42619246e-02, 3.42619246e-02],
        [2.87882504e-02, 2.87882504e-02]]]), array([[0.04980034, 0.01618437, 0.05959382],
       [0.23502553, 0.00324998, 0.11647464],
       [0.01620487, 1.11811249, 0.02880609]]), array([[0.01685251, 0.01321456, 0.17802228],
       [0.15143584, 0.00206186, 0.18196502],
       [0.01490279, 1.13483281, 0.06843992]])]
avg grads absolute err: 0.10023793100480423
bfe: 18.4535, gMu: 1.30541, gRho: 0.527259, glVar: 0.610531, gtau: 3.74481, t: 0, [0.35227614 0.31806687 0.32965699]


