true -log Z = -1.9703857356803958
grad check, T = 10
var vals
{'tau': array([0., 0., 0., 0.]), 'Rho': array([[[ 1.03712291, -0.37273356],
        [ 0.36002815,  0.33040439],
        [ 0.64764401, -1.41012052],
        [-0.18347357,  0.72310582]]]), 'Mu': array([[-1.28010196, -9.48147536,  0.99324956, -1.29355215]]), 'lVar': array([[-2.10314271, -2.78747461, -3.74280306, -0.59129916]])}
['gtau', 'gRho', 'gMu', 'glVar']
numerical grads
[array([-2.37044985,  7.94055176, -2.97400675, -2.59609517]), array([[[ 0.03774826, -0.03774826],
        [-1.76853724,  1.76853724],
        [ 0.08838828, -0.08838828],
        [ 0.0241693 , -0.0241693 ]]]), array([[-0.48379302, -1.98567067, -0.23097114, -0.57893126]]), array([[-0.07596564, -0.11964625, -0.11493029, -0.07331691]])]
quad symbolic grads
[array([-2.36374845,  7.94055177, -2.97691764, -2.59988567]), array([[[ 0.03968695, -0.03968695],
        [-1.76853724,  1.76853724],
        [ 0.08884014, -0.08884014],
        [ 0.02409946, -0.02409946]]]), array([[-0.48143209, -1.98567067, -0.16566372, -0.5960072 ]]), array([[-0.06939673, -0.11964625, -0.13227218, -0.09040174]])]
relative errs
[array([2.82705706e-03, 1.67518496e-10, 9.78778606e-04, 1.46007946e-03]), array([[[5.13582412e-02, 5.13582412e-02],
        [8.17526412e-10, 8.17526036e-10],
        [5.11220255e-03, 5.11220255e-03],
        [2.88948661e-03, 2.88948661e-03]]]), array([[4.88003119e-03, 2.92384854e-12, 2.82751453e-01, 2.94956324e-02]]), array([[8.64720613e-02, 1.28086191e-10, 1.50890525e-01, 2.33027274e-01]])]
avg grads absolute err: 0.045575137734312196
bfe: 11.5594, gMu: 0.807193, gRho: 0.480291, glVar: 0.102929, gtau: 3.97028, t: 0, [0.28654242 0.00165821 0.38934708 0.32245229]


grad check, T = 20
var vals
{'tau': array([0., 0., 0., 0.]), 'Rho': array([[[ 1.03712291, -0.37273356],
        [ 0.36002815,  0.33040439],
        [ 0.64764401, -1.41012052],
        [-0.18347357,  0.72310582]]]), 'Mu': array([[-1.28010196, -9.48147536,  0.99324956, -1.29355215]]), 'lVar': array([[-2.10314271, -2.78747461, -3.74280306, -0.59129916]])}
['gtau', 'gRho', 'gMu', 'glVar']
numerical grads
[array([-2.37045664,  7.94063501, -2.97439551, -2.59578286]), array([[[ 0.03812176, -0.03812176],
        [-1.76853724,  1.76853724],
        [ 0.08850182, -0.08850182],
        [ 0.02305847, -0.02305847]]]), array([[-0.48306399, -1.98567067, -0.21910746, -0.59152396]]), array([[-0.07292147, -0.11964625, -0.1176602 , -0.08720101]])]
quad symbolic grads
[array([-2.37160871,  7.94063502, -2.97491816, -2.59410814]), array([[[ 0.03798687, -0.03798687],
        [-1.76853724,  1.76853724],
        [ 0.08746805, -0.08746805],
        [ 0.02534148, -0.02534148]]]), array([[-0.48280271, -1.98567067, -0.19005331, -0.59999153]]), array([[-0.07518926, -0.11964625, -0.12564262, -0.0948784 ]])]
relative errs
[array([4.86013063e-04, 1.67391913e-10, 1.75714377e-04, 6.45167409e-04]), array([[[3.53851139e-03, 3.53851139e-03],
        [8.17526412e-10, 8.17526036e-10],
        [1.16807726e-02, 1.16807726e-02],
        [9.90094459e-02, 9.90094459e-02]]]), array([[5.40883539e-04, 2.93055795e-12, 1.32602303e-01, 1.43148339e-02]]), array([[3.10990699e-02, 5.36648180e-11, 6.78429228e-02, 8.80424288e-02]])]
avg grads absolute err: 0.028210339908449865
bfe: 11.5591, gMu: 0.81463, gRho: 0.479833, glVar: 0.103839, gtau: 3.97032, t: 0, [0.28772571 0.00165845 0.38903229 0.32158354]


grad check, T = 50
var vals
{'tau': array([0., 0., 0., 0.]), 'Rho': array([[[ 1.03712291, -0.37273356],
        [ 0.36002815,  0.33040439],
        [ 0.64764401, -1.41012052],
        [-0.18347357,  0.72310582]]]), 'Mu': array([[-1.28010196, -9.48147536,  0.99324956, -1.29355215]]), 'lVar': array([[-2.10314271, -2.78747461, -3.74280306, -0.59129916]])}
['gtau', 'gRho', 'gMu', 'glVar']
numerical grads
[array([-2.37065076,  7.94049066, -2.97464554, -2.59519436]), array([[[ 0.03811834, -0.03811834],
        [-1.76853724,  1.76853724],
        [ 0.0884014 , -0.0884014 ],
        [ 0.02312103, -0.02312103]]]), array([[-0.48313619, -1.98567067, -0.21350237, -0.59705687]]), array([[-0.07331828, -0.11964625, -0.11929929, -0.0915735 ]])]
quad symbolic grads
[array([-2.37067141,  7.94049066, -2.97452917, -2.59529007]), array([[[ 0.03811638, -0.03811638],
        [-1.76853724,  1.76853724],
        [ 0.08764542, -0.08764542],
        [ 0.0239713 , -0.0239713 ]]]), array([[-0.48315629, -1.98567067, -0.21114553, -0.59908569]]), array([[-0.07341207, -0.11964625, -0.12115538, -0.09319014]])]
relative errs
[array([8.71381694e-06, 1.70328113e-10, 3.91194457e-05, 3.68802940e-05]), array([[[5.14866917e-05, 5.14866917e-05],
        [8.32592986e-10, 8.32592861e-10],
        [8.55168476e-03, 8.55168476e-03],
        [3.67750570e-02, 3.67750570e-02]]]), array([[4.16047214e-05, 1.53992115e-12, 1.10389022e-02, 3.39803711e-03]]), array([[1.27923985e-03, 2.06072753e-11, 1.55582856e-02, 1.76540211e-02]])]
avg grads absolute err: 0.006990563142481215
bfe: 11.5597, gMu: 0.819765, gRho: 0.479568, glVar: 0.101851, gtau: 3.97025, t: 0, [0.28759672 0.00165861 0.38896451 0.32178015]


grad check, T = 100
var vals
{'tau': array([0., 0., 0., 0.]), 'Rho': array([[[ 1.03712291, -0.37273356],
        [ 0.36002815,  0.33040439],
        [ 0.64764401, -1.41012052],
        [-0.18347357,  0.72310582]]]), 'Mu': array([[-1.28010196, -9.48147536,  0.99324956, -1.29355215]]), 'lVar': array([[-2.10314271, -2.78747461, -3.74280306, -0.59129916]])}
['gtau', 'gRho', 'gMu', 'glVar']
numerical grads
[array([-2.37067633,  7.94046649, -2.9746685 , -2.59512166]), array([[[ 0.03811824, -0.03811824],
        [-1.76853724,  1.76853724],
        [ 0.08828401, -0.08828401],
        [ 0.02315385, -0.02315385]]]), array([[-0.4831402 , -1.98567067, -0.21242914, -0.59812608]]), array([[-0.07333169, -0.11964625, -0.11980104, -0.09228545]])]
quad symbolic grads
[array([-2.37067651,  7.94046649, -2.97484839, -2.59494159]), array([[[ 0.03811822, -0.03811822],
        [-1.76853724,  1.76853724],
        [ 0.0882733 , -0.0882733 ],
        [ 0.02318809, -0.02318809]]]), array([[-0.48313797, -1.98567067, -0.20905325, -0.59759674]]), array([[-0.07333077, -0.11964625, -0.12053567, -0.09185775]])]
relative errs
[array([7.68648505e-08, 1.68806736e-10, 6.04748520e-05, 6.93888221e-05]), array([[[5.73337861e-07, 5.73337861e-07],
        [8.22548771e-10, 8.22547641e-10],
        [1.21332998e-04, 1.21332998e-04],
        [1.47879084e-03, 1.47879084e-03]]]), array([[4.61620811e-06, 6.01543230e-12, 1.58918180e-02, 8.85002044e-04]]), array([[1.24624383e-05, 5.36927716e-11, 6.13210755e-03, 4.63457454e-03]])]
avg grads absolute err: 0.0015445958768780077
bfe: 11.5598, gMu: 0.818865, gRho: 0.479529, glVar: 0.101343, gtau: 3.97023, t: 0, [0.28759551 0.00165862 0.38902396 0.32172191]


true -log Z = -1.9703857356803958
grad check, T = 200
var vals
{'tau': array([0., 0., 0., 0.]), 'Rho': array([[[ 1.03712291, -0.37273356],
        [ 0.36002815,  0.33040439],
        [ 0.64764401, -1.41012052],
        [-0.18347357,  0.72310582]]]), 'Mu': array([[-1.28010196, -9.48147536,  0.99324956, -1.29355215]]), 'lVar': array([[-2.10314271, -2.78747461, -3.74280306, -0.59129916]])}
['gtau', 'gRho', 'gMu', 'glVar']
numerical grads
[array([-2.37067715,  7.9404657 , -2.97467461, -2.59511394]), array([[[ 0.03811824, -0.03811824],
        [-1.76853724,  1.76853724],
        [ 0.08828312, -0.08828312],
        [ 0.02319056, -0.02319056]]]), array([[-0.48313995, -1.98567067, -0.21238474, -0.59817073]]), array([[-0.07333164, -0.11964625, -0.11981754, -0.09231975]])]
quad symbolic grads
[array([-2.37067713,  7.9404657 , -2.97469089, -2.59509769]), array([[[ 0.03811824, -0.03811824],
        [-1.76853724,  1.76853724],
        [ 0.08832949, -0.08832949],
        [ 0.02313952, -0.02313952]]]), array([[-0.48313967, -1.98567067, -0.21156327, -0.59813949]]), array([[-0.07333143, -0.11964625, -0.12007895, -0.09230872]])]
relative errs
[array([8.81816551e-09, 1.61923774e-10, 5.47269994e-06, 6.26415676e-06]), array([[[9.54612134e-08, 9.54612145e-08],
        [8.22549273e-10, 8.22548143e-10],
        [5.25211599e-04, 5.25211599e-04],
        [2.20106781e-03, 2.20106781e-03]]]), array([[5.72524348e-07, 2.91937560e-12, 3.86783524e-03, 5.22278308e-05]]), array([[2.88715151e-06, 2.00854355e-11, 2.18173894e-03, 1.19496101e-04]])]
avg grads absolute err: 0.0005844627520597802
bfe: 11.5598, gMu: 0.819628, gRho: 0.479531, glVar: 0.101341, gtau: 3.97023, t: 0, [0.28759716 0.00165863 0.38899544 0.32174877]


